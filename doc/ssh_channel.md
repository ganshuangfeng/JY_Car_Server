
# 代理

   1. 开启本机代理端口： 
   ```
      ssh -o TCPKeepAlive=yes -D 8668 root@47.106.175.111
   ```
   2. 使用代理连接应用服务器：
   ```
      ssh -o ProxyCommand='nc -x 127.0.0.1:8668 %h %p' username@xxx.xxx.xxx.xxx
   ```

# 端口转发

   1. 在本地建立转发端口
   ```
   ssh -o TCPKeepAlive=yes -L <本地端口>:<阿里云内网地址>:<端口> root@47.106.175.111
   ```
   2. 通过本地端口连接服务器
   ```
   将原本要连接的服务器 ip 改为 127.0.0.1 ，端口改为上述的 <本地端口>
   ```
# 反向端口转发

   1. 在远程建立转发端口
   ```
   ssh -R <远程端口>:127.0.0.1:<本地端口> root@47.106.175.111 "vmstat 30"
   ```
   2. 通过远程端口连接本地主机
   ```
   远程主机的<远程端口>，将会转发到本地主机的 <本地端口>
   ```   

# 举例
   1. 在本地开启代理端口 8668 ，通过 47.106.175.111
      
   ```
   ssh -o TCPKeepAlive=yes -D 8668 root@47.106.175.111
   ```

   2. 使用上述的代理，通过远程的 47.106.175.111 连接 172.18.107.237
   ```
   ssh -o ProxyCommand='nc -x 127.0.0.1:8668 %h %p' root@172.18.107.237
   ```
   
   3. 通过远程的 47.106.175.111 连接 172.18.107.237，并在 172.18.107.237 上建立远程转发端口 5211，转发到 本机
   ```
   ssh -o ProxyCommand='nc -x 127.0.0.1:8668 %h %p' -R 5211:127.0.0.1:5211 root@172.18.107.237 
   ```
   4. 建立本地转发端口 9669 ，转发到远程主机 47.106.175.111 所在的局域网中的 172.18.107.237:3306
   ```
   ssh -o TCPKeepAlive=yes -L 9669:172.18.107.237:3306 root@47.106.175.111
   ```
      

